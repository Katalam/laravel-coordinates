<?php

declare(strict_types=1);

use Katalam\Coordinates\Dtos\Coordinate;
use Katalam\Coordinates\Enums\CoordinateFormat;

describe('DMS', function () {
    it('can convert', function (float $lat, float $long, int $precision, string $expected) {
        $coordinate = Coordinate::fromLatLng($lat, $long);

        expect($coordinate->format(CoordinateFormat::DMS, $precision))->toBe($expected);
    })
        ->with([
            [52.516_253_403_348_74, 13.377_625_381_177_886, -1, '52°30\'58.512252" N 013°22\'39.451372" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 10, '52°30\'58.5122520555" N 013°22\'39.4513722404" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 5, '52°30\'58.51225" N 013°22\'39.45137" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 4, '52°30\'58.5123" N 013°22\'39.4514" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 3, '52°30\'58.512" N 013°22\'39.451" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 2, '52°30\'58.51" N 013°22\'39.45" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 1, '52°30\'58.5" N 013°22\'39.5" E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 0, '52°30\'59" N 013°22\'39" E'],
        ]);
});

describe('DDM', function () {
    it('can convert', function (float $lat, float $long, int $precision, string $expected) {
        $coordinate = Coordinate::fromLatLng($lat, $long);

        expect($coordinate->format(CoordinateFormat::DDM, $precision))->toBe($expected);
    })
        ->with([
            [52.516_253_403_348_74, 13.377_625_381_177_886, -1, '52°30.975204\' N 013°22.657523\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 10, '52°30.9752042009\' N 013°22.6575228707\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 5, '52°30.97520\' N 013°22.65752\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 4, '52°30.9752\' N 013°22.6575\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 3, '52°30.975\' N 013°22.658\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 2, '52°30.98\' N 013°22.66\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 1, '52°31.0\' N 013°22.7\' E'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 0, '52°31\' N 013°23\' E'],
        ]);
});

describe('UTM', function () {
    it('can convert to utm', function (float $lat, float $long, int $precision, string $expected) {
        $coordinate = Coordinate::fromLatLng($lat, $long);

        expect($coordinate->format(CoordinateFormat::UTM, $precision))->toBe($expected);
    })
        ->with([
            [52.516_253_403_348_74, 13.377_625_381_177_886, -1, '33U 389912.653201 5819696.850323'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 14, '33U 389912.653201401 5819696.850323285'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 1, '33U 389912.7 5819696.9'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 2, '33U 389912.65 5819696.85'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 3, '33U 389912.653 5819696.850'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 4, '33U 389912.6532 5819696.8503'],
        ]);
});

describe('GeoHash', function () {
    it('can convert to geohash', function (float $lat, float $long, int $precision, string $expected) {
        $coordinate = Coordinate::fromLatLng($lat, $long);

        expect($coordinate->format(CoordinateFormat::GeoHash, $precision))->toBe($expected);
    })
        ->with([
            [52.516_253_403_348_74, 13.377_625_381_177_886, 12, 'u33db2m3370m'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 11, 'u33db2m3370'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 10, 'u33db2m337'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 9, 'u33db2m33'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 8, 'u33db2m3'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 7, 'u33db2m'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 6, 'u33db2'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 5, 'u33db'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 4, 'u33d'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 3, 'u33'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 2, 'u3'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 1, 'u'],
            [52.516_253_403_348_74, 13.377_625_381_177_886, 0, ''],
        ]);
});
